{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  position: 'topRight',\n  iconColor: '#fff',\n  messageColor: '#fff',\n});\n\nexport async function searchImage(request, page = 1, per_page = 20) {\n  const API_KEY = '49253518-6fbcd3e4502fdc6eae88c44f3';\n  const URL =\n    'https://pixabay.com/api/?key=' +\n    API_KEY +\n    '&q=' +\n    encodeURIComponent(request) +\n    '&image_type=photo' +\n    '&orientation=horizontal' +\n    '&safesearch=true' +\n    '&page=' +\n    page +\n    '&per_page=' +\n    per_page;\n  try {\n    if (request == '') {\n      throw new Error('Please enter something!');\n    }\n    const result = await axios.get(URL);\n    if (result.data.hits == 0) {\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please, try again!'\n      );\n    }\n\n    return { urls: [...result.data.hits], total: result.data.totalHits };\n  } catch (err) {\n    iziToast.error({\n      iconUrl: 'img/error.svg',\n      message: err.message,\n    });\n    // return [];\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery = new SimpleLightbox('.gallery a');\n\nexport function renderGallary(images, galleryHTML) {\n  let markup = images\n    .map(\n      image => `\n      <li>\n        <a href=\"${image.largeImageURL}\"><img src=\"${image.webformatURL}\" alt=\"${image.tags}\" width=\"360\" height=\"200\" /></a>\n        <table class=\"caption\">\n          <thead>\n            <tr>\n              <th>Likes</th>\n              <th>Views</th>\n              <th>Comments</th>\n              <th>Downloads</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>${image.likes}</td>\n              <td>${image.views}</td>\n              <td>${image.comments}</td>\n              <td>${image.downloads}</td>\n            </tr>\n          </tbody>\n        </table>\n      </li>`\n    )\n    .join('');\n\n  // const galleryOption = {\n  //   captionSelector: 'img',\n  //   captionType: 'attr',\n  //   captionsData: 'alt',\n  //   captionDelay: 250,\n  // };\n  galleryHTML.insertAdjacentHTML('beforeend', markup);\n\n  // const imgLd = galleryHTML.querySelectorAll('img');\n  // console.log(' renderGallary imgLd:', imgLd);\n\n  // const imgLdP = [...imgLd].map(img => {\n  //   return new Promise((resolve, reject) => {\n  //     img.onload = () => resolve(img);\n  //     if (0) {\n  //       reject();\n  //     }\n  //   });\n  // });\n  // console.log(' renderGallary imgLdP:', imgLdP);\n\n  // Promise.all(imgLdP).then();\n\n  gallery.refresh();\n\n  //   gallery.on('show.simplelightbox', function () {\n  //     // Do somethingâ€¦\n  //   });\n\n  // gallery.on('error.simplelightbox', function (e) {\n  //   console.log(e); // Some usefull information\n  // });\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { searchImage } from './js/pixabay-api';\nimport { renderGallary } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loading'),\n  moreImgBtn: document.getElementById('moreImgBtn'),\n  request: document.querySelector('.form input'),\n  submitBtn: document.querySelector('.form button'),\n};\n\nrefs.form.addEventListener('submit', handleSubmitClick);\nlet page,\n  per_page = 20,\n  request;\n\nasync function handleSubmitClick(event) {\n  event.preventDefault();\n  refs.request.setAttribute('readonly', true); //readonly for input\n  refs.submitBtn.disabled = true; // disable \"Submite\" button\n  refs.loader.classList.remove('hidden'); // show loader\n\n  page = 1;\n  request = refs.request.value.trim();\n  const images = await searchImage(request, page, per_page);\n\n  refs.request.removeAttribute('readonly'); // Restore elements\n  refs.submitBtn.disabled = false; //               state\n\n  refs.loader.classList.add('hidden'); // hide loader\n  if (!images) {\n    return;\n  }\n\n  refs.gallery.innerHTML = '';\n  refs.request.value = '';\n  renderGallary(images.urls, refs.gallery);\n  needMoreBtnCheck(images); //   Show/hide \"More\" button\n}\n\nasync function handleMoreClick(event) {\n  refs.loader.classList.remove('hidden'); //show loader text\n  const images = await searchImage(request, ++page, per_page);\n  if (!images) {\n    return;\n  }\n\n  const lastGalleryCard = refs.gallery.lastElementChild; //remember last element before new will add\n  renderGallary(images.urls, refs.gallery);\n  refs.loader.classList.add('hidden'); // hide loader text\n  needMoreBtnCheck(images); //   Show/hide \"More\" button\n\n  const { top: lastCardPos } = lastGalleryCard.getBoundingClientRect();\n  window.scrollBy({ top: lastCardPos - 24, behavior: 'smooth' }); //scroll to top border of the last card\n}\n\nfunction needMoreBtnCheck(images) {\n  if (images.urls.length < per_page || images.total === page * per_page) {\n    refs.moreImgBtn.classList.add('hidden'); //hide \"More\" button\n    refs.moreImgBtn.removeEventListener('click', handleMoreClick);\n    iziToast.info({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    refs.moreImgBtn.classList.remove('hidden'); //show \"More\" button\n    refs.moreImgBtn.addEventListener('click', handleMoreClick);\n  }\n}\n"],"names":["iziToast","searchImage","request","page","per_page","URL","result","axios","err","gallery","SimpleLightbox","renderGallary","images","galleryHTML","markup","image","refs","handleSubmitClick","event","needMoreBtnCheck","handleMoreClick","lastGalleryCard","lastCardPos"],"mappings":"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"}